<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Woodora - Create Order</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f9f9f9;
        }
        .order-form-container {
            background: #fff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            max-width: 600px;
            margin: 50px auto;
        }
        .order-form-container h2 {
            font-weight: 600;
            color: #333;
        }
        .form-label {
            font-weight: 500;
            color: #444;
        }
        .btn-woodora {
            background: #8b4513;
            color: #fff;
        }
        .btn-woodora:hover {
            background: #6f3410;
            color: #fff;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="order-form-container">
        <h2 class="text-center mb-4">ðŸª‘ Create New Furniture Order</h2>
        <form id="orderForm">

            <!-- Customer Email & Qty -->
            <div class="row mb-3 g-3">
                <div class="col-md-12">
                    <label for="email" class="form-label">Customer Email</label>
                    <input type="email" class="form-control" id="email" placeholder="Enter your Email" required>
                </div>
                <div class="col-md-6">
                    <label for="qty" class="form-label">Order Quantity</label>
                    <input type="number" class="form-control" placeholder="Qty" id="qty" required>
                </div>
                <div class="col-md-6">
                    <label for="orderType" class="form-label">Order Type</label>
                    <select class="form-select" id="orderType" required>
                        <option value="Takeaway">Takeaway</option>
                        <option value="Delivery">Delivery</option>
                    </select>
                </div>
            </div>

            <!-- Order Date & Status -->
            <div class="row mb-3 g-3">
                <div class="col-md-6">
                    <label for="orderDatetime" class="form-label">Order Date</label>
                    <input type="date" class="form-control" id="orderDatetime" required>
                </div>
                <div class="col-md-6">
                    <input type="hidden" id="status" value="Pending">
                </div>
            </div>

            <!-- Buttons -->
            <div class="d-flex justify-content-between">
                <button type="button" id="orderSave" class="btn btn-woodora btn-sm w-100 mx-1">Submit Order</button>
                <a href="#" style="text-decoration: none">
                    <button type="button" id="openDelivery"
                            class="btn btn-sm w-100 mx-1 text-white"
                            data-bs-toggle="modal" data-bs-target="#deliveryModal"
                            style="background: #e67e22;">
                        Delivery
                    </button>
                                        </a>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <!--delivery-->


<div class="modal fade" id="deliveryModal" tabindex="-1" aria-labelledby="deliveryModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg rounded-4">
            <div class="modal-header border-0 bg-light">
                <h5 class="modal-title fw-bold text-brown" id="deliveryModalLabel">Delivery Information</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <div class="modal-body p-4">
                <form id="deliveryForm">
                    <div class="mb-3">
                        <label for="fullName" class="form-label fw-semibold">Full Name</label>
                        <input type="text" class="form-control woodora-input" id="fullName" placeholder="Full Name" required>
                    </div>

                    <div class="mb-3">
                        <label for="phoneNumber" class="form-label fw-semibold">Phone Number</label>
                        <input type="text" class="form-control woodora-input" id="phoneNumber" placeholder="Phone Number" required>
                    </div>

                    <div class="mb-3">
                        <label for="deliveryEmail" class="form-label fw-semibold">Email Address</label>
                        <input type="email" class="form-control woodora-input" id="deliveryEmail" placeholder="your@email.com" required>
                    </div>

                    <div class="mb-3">
                        <label for="address" class="form-label fw-semibold">Address</label>
                        <input type="text" class="form-control woodora-input" id="address" placeholder="Enter your address" required>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="deliveryDate" class="form-label fw-semibold">Delivery Date</label>
                            <input type="date" class="form-control woodora-input" id="deliveryDate" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="deliveryTime" class="form-label fw-semibold">Delivery Time</label>
                            <input type="time" class="form-control woodora-input" id="deliveryTime" required>
                        </div>
                    </div>
                </form>
            </div>

            <div class="modal-footer border-0">
                <button type="button" class="btn btn-outline-secondary px-4 rounded-3" data-bs-dismiss="modal">Close</button>
                <button type="button" id="deliveryButton" class="btn woodora-btn px-4 rounded-3">Submit Now</button>
            </div>
        </div>
    </div>
</div>

<style>
    /* Woodora theme colors */
    .text-brown {
        color: #5a3e2b;
    }

    .woodora-input {
        border: 2px solid #d4a373;
        border-radius: 10px;
        padding: 10px;
        transition: all 0.3s ease;
        background-color: #faf7f4;
    }
    .woodora-input:focus {
        border-color: #8d5524;
        box-shadow: 0 0 0 0.2rem rgba(141, 85, 36, 0.25);
        background-color: #fff;
    }

    .woodora-btn {
        background-color: #8d5524;
        color: #fff;
        font-weight: 600;
        border: none;
        transition: all 0.3s ease;
    }
    .woodora-btn:hover {
        background-color: #5a3e2b;
    }

    .modal-content {
        background-color: #fffaf5; /* warm beige background */
    }
</style>




<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="javascript/order.js"></script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap"></script>

<script>

    $(document).ready(function () {
        $('#deliveryButton').on('click', function (e) {
            e.preventDefault();

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function (position) {
                    const deliveryData = {
                        fullName: $('#fullName').val(),
                        phoneNumber: $('#phoneNumber').val(),
                        email: $('#deliveryEmail').val(),
                        address: $('#address').val(),
                        date: $('#deliveryDate').val(),
                        time: $('#deliveryTime').val(),
                        latitude: position.coords.latitude,
                        longitude: position.coords.longitude
                    };

                    sendDelivery(deliveryData);
                }, function () {
                    alert("Location access denied");
                });
            } else {
                alert("Geolocation is not supported");
            }
        });

        function sendDelivery(deliveryData) {
            $.ajax({
                url: "http://localhost:8080/api/v1/delivery/save",
                method: "POST",
                contentType: "application/json",
                data: JSON.stringify(deliveryData),
                headers: {
                    "Authorization": "Bearer " + localStorage.getItem("token")
                },
                success: function (response) {
                    Swal.fire({
                        icon: "success",
                        title: "Success!",
                        text: response.message
                    });
                    $('#deliveryForm')[0].reset();
                },
                error: function (xhr) {
                    Swal.fire({
                        icon: "error",
                        title: "Oops...",
                        text: xhr.responseJSON?.message || "Something went wrong!"
                    });
                }
            });
        }

    });
</script>
</body>
</html>
